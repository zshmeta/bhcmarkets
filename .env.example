# BHC Markets Environment Configuration
# =====================================
# Copy this file to .env and customize for your environment.
# All services share this file via root-level dotenv loading.

# =============================================================================
# COMMON CONFIGURATION
# =============================================================================

# Node environment: development | production | test
NODE_ENV=development

# Database connection (required for all services)
DATABASE_URL=postgresql://bhcm:bhcm@localhost:5432/bhcmarkets

# Redis connection (optional in dev, recommended in production)
# Used for: price caching, pub/sub between services, session storage
REDIS_URL=redis://localhost:6379

# =============================================================================
# BACKEND API (port 8080)
# =============================================================================

# HTTP server port
PORT=8080

# JWT secret for signing access/refresh tokens
# IMPORTANT: Use a strong 256-bit secret in production!
JWT_SECRET=dev-only-change-me-in-production

# Token TTL configuration
ACCESS_TTL_SEC=900           # 15 minutes
REFRESH_TTL_SEC=2592000      # 30 days

# Session management
MAX_SESSIONS_PER_USER=10

# Password hashing cost (higher = more secure but slower)
BCRYPT_ROUNDS=10

# CORS allowed origins (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:5174,http://localhost:5175

# =============================================================================
# ORDER ENGINE (REST: 4003, WebSocket: 4004)
# =============================================================================

# Order engine HTTP API port
# ORDER_ENGINE_PORT=4003

# Order engine WebSocket port
# ORDER_ENGINE_WS_PORT=4004

# Order limits
MAX_ORDERS_PER_ACCOUNT=100
ORDER_EXPIRATION_DAYS=30
PRICE_DEVIATION_TOLERANCE=0.1

# Trade processing
TRADE_BATCH_SIZE=100
TRADE_FLUSH_INTERVAL_MS=1000

# Rate limiting
RATE_LIMIT_ORDERS_PER_SECOND=10
RATE_LIMIT_BURST=50

# =============================================================================
# MARKET DATA SERVICE (REST: 4001, WebSocket: 4002)
# =============================================================================

# Market data HTTP API port
# MARKET_DATA_PORT=4001

# Market data WebSocket port
# MARKET_DATA_WS_PORT=4002

# Yahoo Finance polling configuration
YAHOO_POLL_INTERVAL_MS=15000
YAHOO_BATCH_SIZE=20

# Financial Modeling Prep API (optional - for additional data)
# Get a free key at: https://financialmodelingprep.com/
# FMP_API_KEY=your-api-key

# Circuit breaker settings
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_MS=60000

# Candle aggregation
CANDLE_FLUSH_INTERVAL_MS=60000

# =============================================================================
# FRONTEND APPS (Vite environment variables)
# =============================================================================

# Auth app (port 5173)
VITE_API_URL=http://localhost:8080

# Platform app (port 5174)
VITE_API_URL=http://localhost:8080
VITE_ORDER_ENGINE_URL=http://localhost:4003
VITE_MARKET_DATA_WS_URL=ws://localhost:4002/ws
VITE_ORDER_ENGINE_WS_URL=ws://localhost:4004/ws

# =============================================================================
# EMAIL WORKER (Cloudflare Worker)
# =============================================================================

# Email provider: resend | sendgrid | mailgun | postmark
# EMAIL_PROVIDER=resend

# Provider API keys (set via wrangler secret in production)
# RESEND_API_KEY=re_xxxx
# SENDGRID_API_KEY=SG.xxxx
# MAILGUN_API_KEY=key-xxxx
# MAILGUN_DOMAIN=mg.yourdomain.com
# POSTMARK_API_KEY=xxxx

# Platform details for email templates
PLATFORM_NAME=BHC Markets
PLATFORM_URL=http://localhost:5173
SUPPORT_EMAIL=support@bhcmarkets.com

# =============================================================================
# LOGGING
# =============================================================================

# Log level: trace | debug | info | warn | error | fatal
LOG_LEVEL=info
